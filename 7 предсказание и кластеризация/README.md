# Кластеризация и множественное предсказание

# 1 Кластеризация описаний фильмов

## Описание

Ноутбук "фильмы кластеризация.ipynb" содержит реализацию кластеризации описаний фильмов для выявления тематических групп. Использует предобработку текста, векторизацию (TF-IDF, BERT), снижение размерности (SVD), алгоритмы кластеризации (Spectral, Agglomerative, DBSCAN, KMeans) и метрики качества.

Данные: Описания ~21 000 фильмов (из предыдущего парсинга, папка "3 парсинг").

## Основные шаги

- Импорт библиотек (pandas, numpy, sklearn, pymorphy3, transformers, wordcloud и т.д.)  
- Предобработка: Загрузка стоп-слов, токенизация (razdel), лемматизация (pymorphy3), очистка  
- Векторизация: TF-IDF/CountVectorizer, BERT эмбеддинги
- Снижение размерности: TruncatedSVD, нормализация 
- Кластеризация: LDA, SpectralClustering, AgglomerativeClustering, DBSCAN, KMeans/MiniBatchKMeans  
- Метрики: Silhouette, Davies-Bouldin, Calinski-Harabasz, pairwise_distances  
- Визуализации: облака слов по кластерам, дендрограммы
- Анализ  

## Результаты

- Кластеры: Например, кластер о школах/подростках (фильмы с темами учебы, дружбы, конкуренции).    
- Визуализации: облака слов (ключевые слова: "школа", "друзья", "любовь"). На основе этих облаков слов я так оценил различные методы кластеризации:

LDA оценил на 2 балла, иерархическую кластеризацию с tf-idf векторизатором на 4 балла, кластеризацию K-means с tf-idf векторизатором на 8 баллов, DBSCAN на 0 баллов, иерархическую кластеризацию с BERT векторизатором на 3 балла, кластеризацию SpectralClustering с BERT векторизатором на 6 баллов, кластеризацию SpectralClustering с tf-idf векторизатором на 4 балла, кластеризацию K-means с BERT векторизатором на 2 балла  

- Таким образом, лучшей кластеризацией в данном случае получилась K-means с tf-idf векторизатором

<br>

# 2 Множественное предсказание жанров фильмов

## Описание

Ноутбук "фильмы предсказания.ipynb" содержит реализацию множественного предсказания жанров фильмов по описаниям с помощью ML-моделей. Использует предобработку текста, векторизацию (TF-IDF, FastText, BERT), мультилейбл-классификацию и оптимизацию гиперпараметров.

## Основные шаги

- Импорт библиотек (pandas, sklearn, pymorphy3, transformers, optuna, xgboost и т.д.)  
- Предобработка: Токенизация (razdel), лемматизация (pymorphy3), расширенные стоп-слова  
- Кодирование жанров: MultiLabelBinarizer  
- Векторизация: TF-IDF (TfidfVectorizer), FastText (gensim), BERT эмбеддинги
- Снижение размерности: TruncatedSVD, нормализация 
- Модели: MultiOutputClassifier с RandomForest, LogisticRegression, MultinomialNB, SVC, GradientBoosting, XGBoost  
- Оптимизация: RandomizedSearchCV, Optuna для гиперпараметров  
- Метрики: classification_report, f1_score, accuracy, roc_auc, precision_recall_curve   

## Результаты

- Лучшая модель: TF-IDF + MultiOutputClassifier (LogisticRegression/XGBoost)  


## Автор

Алтухов Николай  

2026